<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-6 mx-auto">
                <h3 class="display-4 text-center">Quản Lý sinh viên</h3>
                <form id="formQLSV">
                    <div class="row">
                        <div class="col-6 form-group">
                            <label for="">Mã Sinh Viên : </label>
                            <input type="text" class="form-control" id="txtMaSV">
                            <span id="spanMaSV" class="text-danger"></span>
                        </div>
                        <div class="col-6 form-group">
                            <label for="">Tên Sinh Viên : </label>
                            <input type="text" class="form-control" id="txtTenSV">
                            <span id="spanTenSV" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 form-group">
                            <label for="">Email : </label>
                            <input type="text" class="form-control" id="txtEmail">
                            <span id="spanEmailSV" class="text-danger"></span>
                        </div>
                        <div class="col-6 form-group">
                            <label for="">Số điện thoại: </label>
                            <input type="number" class="form-control" id="txtSDT">
                            <span id="spanSDT" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 form-group">
                            <label for="">Loại Sinh Viên: </label>
                            <select name="" id="loaiSV" class="form-control">
                                <option>Nghèo</option>
                                <option>Giàu</option>
                                <option>Bình thường</option>
                            </select>
                            <span id="spanKhoaHoc" class="text-danger"></span>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-3 form-group">
                            <label for="">Điểm rèn luyện : </label>
                            <input type="text" class="form-control" id="txtDiemRL">
                            <span id="spanRL" class="text-danger"></span>
                        </div>
                        <div class="col-3 form-group">
                            <label for="">Điểm toán : </label>
                            <input type="text" class="form-control" id="txtDiemToan">
                            <span id="spanToan" class="text-danger"></span>
                        </div>
                        <div class="col-3 form-group">
                            <label for="">Điểm lý : </label>
                            <input type="text" class="form-control" id="txtDiemLy">
                            <span id="spanLy" class="text-danger"></span>
                        </div>
                        <div class="col-3 form-group">
                            <label for="">Điểm hóa : </label>
                            <input type="text" class="form-control" id="txtDiemHoa">
                            <span id="spanHoa" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="form-group text-center">
                        <button type="button" onclick="addStudent()" class="btn btn-success">Thêm Sinh Viên</button>

                        <button type="button" onclick="resetForm()" class="btn btn-dark">Reset</button>
                        <button type="button" onclick="updateStudent()" class="btn btn-info">Cập Nhật</button>
                    </div>
                    <p style="width: 80%;margin: auto; text-align: center;" id="alertMessage" class="alert"></p>
                </form>
                <div class="row">
                    <div class="col-9 form-group">
                        <input placeholder="Nhập tên sinh viên" type="text" class="form-control" id="txtSearch">
                    </div>
                    <div class="col-3 form-group">
                        <button id="btnSearch" onclick="searchStudents()" class="btn btn-primary">Search</button>
                    </div>
                </div>
            </div>
            <div class="col-8 mx-auto">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Mã Sinh Viên</th>
                            <th>Tên Sinh Viên</th>
                            <th>Email</th>
                            <th>Loại Sinh Viên</th>
                            <th>Số Điện Thoại</th>
                            <th>Điểm Trung Bình</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody id="tbodySinhVien">

                    </tbody>
                </table>
                <div id="paginationContainer" class="text-center"></div>
            </div>

        </div>
        <!-- <script>
            class Student {
                constructor(maSV, tenSV, email, sdt, loaiSV, diemRL, diemToan, diemLy, diemHoa) {
                    this.maSV = maSV;
                    this.tenSV = tenSV;
                    this.email = email;
                    this.sdt = sdt;
                    this.loaiSV = loaiSV;
                    this.diemRL = diemRL;
                    this.diemToan = diemToan;
                    this.diemLy = diemLy;
                    this.diemHoa = diemHoa;
                }
                calculateAverage() {
                    // Thực hiện tính điểm trung bình
                    return (parseFloat(this.diemRL) + parseFloat(this.diemToan) + parseFloat(this.diemLy) + parseFloat(this.diemHoa)) / 4;
                }

                // Chuyển đối tượng sinh viên thành một đối tượng plain object
                toJSON() {
                    return {
                        maSV: this.maSV,
                        tenSV: this.tenSV,
                        email: this.email,
                        sdt: this.sdt,
                        loaiSV: this.loaiSV,
                        diemRL: this.diemRL,
                        diemToan: this.diemToan,
                        diemLy: this.diemLy,
                        diemHoa: this.diemHoa
                    };
                }

                // Phương thức tĩnh để tạo một đối tượng sinh viên từ một plain object
                static fromJSON(json) {
                    return new Student(
                        json.maSV,
                        json.tenSV,
                        json.email,
                        json.sdt,
                        json.loaiSV,
                        json.diemRL,
                        json.diemToan,
                        json.diemLy,
                        json.diemHoa
                    );
                }

                render() {
                    var row = document.createElement("tr");
                    row.innerHTML = `
                    <td>${this.maSV}</td>
                    <td style = "width:20%; margin :auto;">${this.tenSV}</td>
                    <td>${this.email}</td>
                    <td>${this.sdt}</td>
                    <td>${this.loaiSV}</td>
                    <td>${this.calculateAverage()}</td>
                    <td style = "width:15%; margin :auto;">
                         <button class="btn btn-primary btn-sm" onclick="editStudent('${this.maSV}')">Edit</button>
                         <button class="btn btn-danger btn-sm" onclick="deleteStudent('${this.maSV}')">Delete</button>
                    </td>
                `;
                    return row;
                }
            }

            function saveStudents(students) {
                localStorage.setItem("students", JSON.stringify(students));
            }

            function loadStudents() {
                var students = [];
                var storedStudents = localStorage.getItem("students");
                if (storedStudents) {
                    var parsedStudents = JSON.parse(storedStudents);
                    if (Array.isArray(parsedStudents)) {
                        students = parsedStudents.map(Student.fromJSON);
                    }
                }
                return students;
            }

            function renderStudents(students) {
                var tbodySinhVien = document.getElementById("tbodySinhVien");
                tbodySinhVien.innerHTML = "";

                students.forEach(function (student) {
                    var row = student.render();
                    tbodySinhVien.appendChild(row);
                });
            }

            var students = loadStudents();
            renderStudents(students);
            function addStudent() {
                // Lấy giá trị từ các trường input
                var maSV = document.getElementById("txtMaSV").value;
                var tenSV = document.getElementById("txtTenSV").value;
                var email = document.getElementById("txtEmail").value;
                var sdt = document.getElementById("txtSDT").value;
                var loaiSV = document.getElementById("loaiSV").value;
                var diemRL = document.getElementById("txtDiemRL").value;
                var diemToan = document.getElementById("txtDiemToan").value;
                var diemLy = document.getElementById("txtDiemLy").value;
                var diemHoa = document.getElementById("txtDiemHoa").value;

                // Kiểm tra tính hợp lệ của dữ liệu đầu vào
                if (maSV === "" || tenSV === "" || email === "" || sdt === "" || diemRL === "" || diemToan === "" || diemLy === "" || diemHoa === "") {
                    alert("Vui lòng điền đầy đủ thông tin sinh viên");
                    return;
                }


                // Tạo đối tượng Student
                var student = new Student(maSV, tenSV, email, sdt, loaiSV, diemRL, diemToan, diemLy, diemHoa);

                // Lưu sinh viên vào danh sách
                students.push(student);

                // Hiển thị danh sách sinh viên
                renderStudents(students);

                // Xóa giá trị nhập trong các trường input
                document.getElementById("txtMaSV").value = "";
                document.getElementById("txtTenSV").value = "";
                document.getElementById("txtEmail").value = "";
                document.getElementById("txtSDT").value = "";
                document.getElementById("loaiSV").value = "Nghèo";
                document.getElementById("txtDiemRL").value = "";
                document.getElementById("txtDiemToan").value = "";
                document.getElementById("txtDiemLy").value = "";
                document.getElementById("txtDiemHoa").value = "";

                // Lưu danh sách sinh viên vào localStorage
                saveStudents(students);
                showMessage("Thêm sinh viên thành công", true);
                // showMessage("Thêm sinh viên thất bại", false);
            }
            function updateStudent() {
                // Lấy giá trị từ các trường input
                var maSV = document.getElementById("txtMaSV").value;
                var tenSV = document.getElementById("txtTenSV").value;
                var email = document.getElementById("txtEmail").value;
                var sdt = document.getElementById("txtSDT").value;
                var loaiSV = document.getElementById("loaiSV").value;
                var diemRL = document.getElementById("txtDiemRL").value;
                var diemToan = document.getElementById("txtDiemToan").value;
                var diemLy = document.getElementById("txtDiemLy").value;
                var diemHoa = document.getElementById("txtDiemHoa").value;

                // Kiểm tra tính hợp lệ của dữ liệu đầu vào
                if (maSV === "" || tenSV === "" || email === "" || sdt === "" || diemRL === "" || diemToan === "" || diemLy === "" || diemHoa === "") {
                    alert("Vui lòng điền đầy đủ thông tin sinh viên");
                    return;
                }

                // Tạo đối tượng Student
                var student = new Student(maSV, tenSV, email, sdt, loaiSV, diemRL, diemToan, diemLy, diemHoa);

                // Tìm vị trí sinh viên cần cập nhật trong danh sách
                var index = students.findIndex(function (item) {
                    return item.maSV === maSV;
                });

                // Kiểm tra xem sinh viên có tồn tại trong danh sách không
                if (index !== -1) {
                    // Cập nhật thông tin sinh viên tại vị trí tìm được
                    students[index] = student;

                    // Hiển thị danh sách sinh viên
                    renderStudents(students);

                    // Xóa giá trị nhập trong các trường input
                    document.getElementById("txtMaSV").value = "";
                    document.getElementById("txtTenSV").value = "";
                    document.getElementById("txtEmail").value = "";
                    document.getElementById("txtSDT").value = "";
                    document.getElementById("loaiSV").value = "Nghèo";
                    document.getElementById("txtDiemRL").value = "";
                    document.getElementById("txtDiemToan").value = "";
                    document.getElementById("txtDiemLy").value = "";
                    document.getElementById("txtDiemHoa").value = "";

                    // Lưu danh sách sinh viên vào localStorage
                    saveStudents(students);
                } else {
                    alert("Sinh viên không tồn tại");
                }
                showMessage("Cập nhật sinh viên thành công", true);
                // showMessage("Cập nhật sinh viên thất bại", false);
            
            }

            function resetForm() {
                // Xóa giá trị nhập trong các trường input
                document.getElementById("txtMaSV").value = "";
                document.getElementById("txtTenSV").value = "";
                document.getElementById("txtEmail").value = "";
                document.getElementById("txtSDT").value = "";
                document.getElementById("loaiSV").value = "Nghèo";
                document.getElementById("txtDiemRL").value = "";
                document.getElementById("txtDiemToan").value = "";
                document.getElementById("txtDiemLy").value = "";
                document.getElementById("txtDiemHoa").value = "";

                // Xóa danh sách sinh viên trong localStorage
                localStorage.removeItem("students");

                // Xóa danh sách sinh viên trên bảng
                var tbodySinhVien = document.getElementById("tbodySinhVien");
                tbodySinhVien.innerHTML = "";
            }
            function editStudent(maSV) {
                // Tìm sinh viên cần chỉnh sửa trong danh sách
                var student = students.find(function (item) {
                    return item.maSV === maSV;
                });

                // Kiểm tra sinh viên có tồn tại hay không
                if (student) {
                    // Đổ dữ liệu sinh viên vào các trường input
                    document.getElementById("txtMaSV").value = student.maSV;
                    document.getElementById("txtTenSV").value = student.tenSV;
                    document.getElementById("txtEmail").value = student.email;
                    document.getElementById("txtSDT").value = student.sdt;
                    document.getElementById("loaiSV").value = student.loaiSV;
                    document.getElementById("txtDiemRL").value = student.diemRL;
                    document.getElementById("txtDiemToan").value = student.diemToan;
                    document.getElementById("txtDiemLy").value = student.diemLy;
                    document.getElementById("txtDiemHoa").value = student.diemHoa;
                }
            }

            function deleteStudent(maSV) {
                // Tìm vị trí sinh viên cần xoá trong danh sách
                var index = students.findIndex(function (item) {
                    return item.maSV === maSV;
                });

                // Kiểm tra sinh viên có tồn tại hay không
                if (index !== -1) {
                    // Xoá sinh viên khỏi danh sách
                    students.splice(index, 1);

                    // Hiển thị danh sách sinh viên
                    renderStudents(students);

                    // Lưu danh sách sinh viên vào localStorage
                    saveStudents(students);
                }
                showMessage("Xóa sinh viên thành công", true);
                
            }
            function searchStudents() {
                // Lấy giá trị từ trường input tìm kiếm
                var searchValue = document.getElementById("txtSearch").value.toLowerCase();

                // Tạo một danh sách sinh viên kết quả tìm kiếm
                var searchResults = students.filter(function (student) {
                    return student.tenSV.toLowerCase().includes(searchValue);
                });

                // Hiển thị danh sách sinh viên tìm kiếm
                renderStudents(searchResults);
            }
            function showMessage(message, success) {
                var alertMessage = document.getElementById("alertMessage");
                alertMessage.textContent = message;
                if (success) {
                    alertMessage.classList.remove("text-danger");
                    alertMessage.classList.add("text-success");
                } else {
                    alertMessage.classList.remove("text-success");
                    alertMessage.classList.add("text-danger");
                }
            }
        </script> -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
            integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
            crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
            integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
            crossorigin="anonymous"></script>
        <!-- <script src="/js/bai2/SinhVien.js"></script> -->
        <script src="./js/bai2/main.js"></script>
        <!-- <script src="./js/bai2/DanhSachSinhVien.js"></script> -->


    </div>
</body>

</html>